library(ggplot2)
library(treeio)
library(ggtree)
tree = ggtree::read.tree(file = "tree.nwk")
tree
ggplot(tree) + geom_tree() + geom_tiplab()
ggplot(tree) + geom_tree() + geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree() + geom_tiplab() + theme_tree2()
ggplot(tree) + geom_tree() + geom_tiplab() + theme_tree()
library(ggplot2)
library(treeio)
library(ggtree)
tree = ggtree::read.tree(file = "RAxML_bipartitionsBranchLabels.raxmlRerun")
tree = ggtree::read.tree(file = "tree.nwk")
tree
ggplot(tree) + geom_tree() + geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree(color="firebrick", size=2, linetype="dotted") + geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree(color="firebrick", size=0.5, linetype="dotted") + geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree(color="firebrick", size=0.25, linetype="dotted") + geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree(color="firebrick", size=0.25, linetype="dotted") + geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree(color="firebrick", size=0.5, linetype="dotted") + geom_tiplab() + theme_tree() + coord_flip()
?geom_tiplab
ggplot(tree) + geom_tree(color="firebrick", size=0.5, linetype="dotted") + coord_flip() + geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree(color="firebrick", size=0.5, linetype="dotted", layout="equal_angle")+ geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree(color="firebrick", size=0.5, linetype="dotted", layout="daylight")+ geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree(color="firebrick", size=0.5, linetype="dotted", layout="roundrect")+ geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree(color="firebrick", size=0.5, linetype="dotted", layout="roundrect") + geom_tiplab() + theme_tree()
tree_rooted <- ape::root(tree_unrooted, outgroup = "Helicobacter_pylori_26695_AAD07685.1", resolve.root=TRUE)
tree_rooted <- ape::root(tree, outgroup = "Helicobacter_pylori_26695_AAD07685.1", resolve.root=TRUE)
?ape:root
?ape::root
tree
tree_unrooted <- ape::unroot(tree)
tree_rooted <- ape::root(tree_unrooted, outgroup = "Helicobacter_pylori_26695_AAD07685.1", resolve.root=TRUE)
tree_unrooted <- ape::unroot(tree)
tree_rooted <- ape::root(tree, outgroup = "Helicobacter_pylori_AAD07685.1", resolve.root=TRUE)
tree_rooted <- ape::root(tree, outgroup = "Helicobacter_pylori_AAD07685.1", resolve.root=TRUE)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree()
tree_rooted <- ape::root(tree, outgroup = "Helicobacter_pylori_AAD07685.1", resolve.root=TRUE)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree()
tree = ggtree::read.tree(file = "tree.nwk")
tree
ggplot(tree) + geom_tree() + geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree(color="firebrick", size=0.5, linetype="dotted", layout="roundrect") + geom_tiplab() + theme_tree()
tree_rooted <- ape::root(tree, outgroup = "Helicobacter_pylori_AAD07685.1", resolve.root=TRUE)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree()
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + ggplot2::xlim(0, 0.06)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + ggplot2::xlim(0, 2)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + ggplot2::xlim(0, 2.5)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + ggplot2::xlim(0, 3)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + xlim(0, 3)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + xlim(0, 3)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + xlim(0, 3)
?read.table
gene_data = read.delim("gene_data.txt")
p1 = ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + xlim(0, 3) + scale_color_viridis(discrete = TRUE)
library(viridis)
p1 = ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + xlim(0, 3) + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_ln, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=From, xend=To, y=y, yend=y, col=Short.name), size=3) + theme(legend.position = "right")
p1 = ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + xlim(0, 3) + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_ln, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=From, xend=To, y=y, yend=y, col=Short.name), size=3) + theme(legend.position = "right")
p3
p1 = ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + xlim(0, 3) + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=as.numeric(Seq_ln), y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=as.numeric(From), xend=as.numeric(To), y=y, yend=y, col=Short.name), size=3) + theme(legend.position = "right")
p3
p1 = ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=as.numeric(Seq_ln), y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=as.numeric(From), xend=as.numeric(To), y=y, yend=y, col=Short.name), size=3) + theme(legend.position = "right")
p3
library(ggplot2)
library(treeio)
library(ggtree)
library(viridis)
tree = ggtree::read.tree(file = "tree.nwk")
tree
ggplot(tree) + geom_tree() + geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree(color="firebrick", size=0.5, linetype="dotted", layout="roundrect") + geom_tiplab() + theme_tree()
tree_rooted <- ape::root(tree, outgroup = "Helicobacter_pylori_AAD07685.1", resolve.root=TRUE)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree()
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + xlim(0, 3)
gene_data = read.delim("gene_data.txt")
p1 = ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=as.numeric(Seq_ln), y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=as.numeric(From), xend=as.numeric(To), y=y, yend=y, col=Short.name), size=3) + theme(legend.position = "right")
p3
library(ggplot2)
library(treeio)
library(ggtree)
library(viridis)
tree = ggtree::read.tree(file = "tree.nwk")
tree
ggplot(tree) + geom_tree() + geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree(color="firebrick", size=0.5, linetype="dotted", layout="roundrect") + geom_tiplab() + theme_tree()
tree_rooted <- ape::root(tree, outgroup = "Helicobacter_pylori_AAD07685.1", resolve.root=TRUE)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree()
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + xlim(0, 3)
gene_data = read.delim("gene_data.txt")
p1 = ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=as.numeric(Seq_Length), y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=as.numeric(Domain_Start), xend=as.numeric(Domain_End), y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "right")
p3
p1 = ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=as.numeric(Seq_Length), y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=as.numeric(Domain_Start), xend=as.numeric(Domain_End), y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p3
library(ggplot2)
library(treeio)
library(ggtree)
library(viridis)
tree = ggtree::read.tree(file = "tree.nwk")
tree
ggplot(tree) + geom_tree() + geom_tiplab() + theme_tree()
ggplot(tree) + geom_tree(color="firebrick", size=0.5, linetype="dotted", layout="roundrect") + geom_tiplab() + theme_tree()
tree_rooted <- ape::root(tree, outgroup = "Helicobacter_pylori_AAD07685.1", resolve.root=TRUE)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree()
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + xlim(0, 3)
gene_data = read.delim("gene_data.txt")
p1 = ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=as.numeric(Seq_Length), y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=as.numeric(Domain_Start), xend=as.numeric(Domain_End), y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel='Domains', data= gene_data, geom=geom_text, mapping=aes(x=From+20, label= Domain_Name), size=2)
p4
p1 = ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=as.numeric(Seq_Length), y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=as.numeric(Domain_Start), xend=as.numeric(Domain_End), y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel='Domains', data= gene_data, geom=geom_text, mapping=aes(x=Domain_Start+20, label= Domain_Name), size=2)
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=as.numeric(Seq_Length), y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=as.numeric(Domain_Start), xend=as.numeric(Domain_End), y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel='Domains', data= gene_data, geom=geom_text, mapping=aes(x=Domain_Start+20, label= Domain_Name), size=2)
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=as.numeric(Seq_Length), y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=as.numeric(Domain_Start), xend=as.numeric(Domain_End), y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p3
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p3
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(x=Prediction, y=TipLabels, fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
gene_data = read.delim("gene_data.txt")
targeting_data = read.delim("targeting_data.txt")
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(x=Prediction, y=TipLabels, fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(x=Plastid_Targeting, y=TipLabels, fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
#p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
p4 = ggplot(targeting_data, aes(x=Prediction, y=TipLabels, fill=Plastid_Targeting)) + geom_tile() + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
#p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
p4 = ggplot(targeting_data, aes(x=Prediction, y=TipLabels, fill=Plastid_Targeting)) + geom_tile() + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting")
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
#p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
p4 = ggplot(targeting_data, aes(x=Prediction, y=TipLabels, fill=Plastid_Targeting)) + geom_tile() + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting")
library(aplot)
p3 %>% insert_right(p4)
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab(Align=TRUE) + hexpand(1) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p3
#p4 = facet_plot(p3, panel = "Targeting", data = gene_data, geom=geom_tile, aes(x=Prediction, y=TipLabels, fill=Seq_Length)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = ggplot(targeting_data, aes(x=Prediction, y=TipLabels, fill=Plastid_Targeting)) + geom_tile() + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting")
#library(aplot)
#p3 %>% insert_right(p4)
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab(Align=TRUE) + hexpand(1.2) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p3
#p4 = facet_plot(p3, panel = "Targeting", data = gene_data, geom=geom_tile, aes(x=Prediction, y=TipLabels, fill=Seq_Length)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = ggplot(targeting_data, aes(x=Prediction, y=TipLabels, fill=Plastid_Targeting)) + geom_tile() + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting")
#library(aplot)
#p3 %>% insert_right(p4)
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab(Align=FALSE) + hexpand(1.2) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p3
#p4 = facet_plot(p3, panel = "Targeting", data = gene_data, geom=geom_tile, aes(x=Prediction, y=TipLabels, fill=Seq_Length)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = ggplot(targeting_data, aes(x=Prediction, y=TipLabels, fill=Plastid_Targeting)) + geom_tile() + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting")
#library(aplot)
#p3 %>% insert_right(p4)
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab(Align=TRUE) + hexpand(1.2) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p3
#p4 = facet_plot(p3, panel = "Targeting", data = gene_data, geom=geom_tile, aes(x=Prediction, y=TipLabels, fill=Seq_Length)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = ggplot(targeting_data, aes(x=Prediction, y=TipLabels, fill=Plastid_Targeting)) + geom_tile() + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting")
#library(aplot)
#p3 %>% insert_right(p4)
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + hexpand(1.2) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Domains", data = gene_data, geom=geom_bar, aes(y=Seq_Length)) + theme(legend.position = "bottom")
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + hexpand(1.2) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Domains", data = gene_data, geom=geom_bar, aes(x=Seq_Length)) + theme(legend.position = "bottom")
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + hexpand(1.2) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Domains", data = gene_data, geom=geom_col, aes(x=Seq_Length)) + theme(legend.position = "bottom")
p4
#p4 = facet_plot(p3, panel = "Targeting", data = gene_data, geom=geom_tile, aes(x=Prediction, y=TipLabels, fill=Seq_Length)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = ggplot(targeting_data, aes(x=Prediction, y=TipLabels, fill=Plastid_Targeting)) + geom_tile() + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting")
#library(aplot)
#p3 %>% insert_right(p4)
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + hexpand(1.2) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Targeting", data = gene_data, geom=geom_col, aes(x=Seq_Length)) + theme(legend.position = "bottom")
p4
#p4 = facet_plot(p3, panel = "Targeting", data = gene_data, geom=geom_tile, aes(x=Prediction, y=TipLabels, fill=Seq_Length)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = ggplot(targeting_data, aes(x=Prediction, y=TipLabels, fill=Plastid_Targeting)) + geom_tile() + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting")
#library(aplot)
#p3 %>% insert_right(p4)
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + hexpand(1.2) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Targeting", data = gene_data, geom=geom_col, aes(x=Seq_Length), orientation = 'y') + theme(legend.position = "bottom")
p4
#p4 = facet_plot(p3, panel = "Targeting", data = gene_data, geom=geom_tile, aes(x=Prediction, y=TipLabels, fill=Seq_Length)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = facet_plot(p3, panel = "Targeting", data = targeting_data, geom=geom_tile, aes(fill=Plastid_Targeting)) + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting") + geom_text()
#p4 = ggplot(targeting_data, aes(x=Prediction, y=TipLabels, fill=Plastid_Targeting)) + geom_tile() + theme(legend.position = "bottom") + scale_fill_gradient(limits=c(0,1), low="white", high="chartreuse4", name = "Plastid Targeting")
#library(aplot)
#p3 %>% insert_right(p4)
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + hexpand(1.2) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Plastid Targeting", data = gene_data, geom=geom_col, aes(x=Seq_Length), orientation = 'y', color="chartreuse4") + theme(legend.position = "bottom")
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + hexpand(1.2) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Plastid Targeting", data = gene_data, geom=geom_col, aes(x=Seq_Length), orientation = 'y', fill="chartreuse4") + theme(legend.position = "bottom")
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + hexpand(1.2) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Plastid Targeting", data = gene_data, geom=geom_col, aes(x=Plastid_Targeting), orientation = 'y', fill="chartreuse4") + theme(legend.position = "bottom")
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + hexpand(3) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Plastid Targeting", data = gene_data, geom=geom_col, aes(x=Plastid_Targeting), orientation = 'y', fill="chartreuse4") + theme(legend.position = "bottom")
p4
---
title: "Visuzalizing Phylogenetics Trees and Associated Data with ggtree"
gene_data = read.delim("gene_data.txt")
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab() + hexpand(3) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Plastid Targeting", data = gene_data, geom=geom_col, aes(x=Plastid_Targeting), orientation = 'y', fill="chartreuse4") + theme(legend.position = "bottom")
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab(size=4) + hexpand(3) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Plastid Targeting", data = gene_data, geom=geom_col, aes(x=Plastid_Targeting), orientation = 'y', fill="chartreuse4") + theme(legend.position = "bottom")
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab(size=2) + hexpand(3) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Plastid Targeting", data = gene_data, geom=geom_col, aes(x=Plastid_Targeting), orientation = 'y', fill="chartreuse4") + theme(legend.position = "bottom")
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab(size=3) + hexpand(1) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Plastid Targeting", data = gene_data, geom=geom_col, aes(x=Plastid_Targeting), orientation = 'y', fill="chartreuse4") + theme(legend.position = "bottom")
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab(size=3) + hexpand(1.5) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Plastid Targeting", data = gene_data, geom=geom_col, aes(x=Plastid_Targeting), orientation = 'y', fill="chartreuse4") + theme(legend.position = "bottom")
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab(size=2.5) + hexpand(1) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Plastid Targeting", data = gene_data, geom=geom_col, aes(x=Plastid_Targeting), orientation = 'y', fill="chartreuse4") + theme(legend.position = "bottom")
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab(size=2.5) + hexpand(1.25) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Plastid Targeting", data = gene_data, geom=geom_col, aes(x=Plastid_Targeting), orientation = 'y', fill="chartreuse4") + theme(legend.position = "bottom")
p4
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab(size=2.5) + hexpand(1.5) + theme_tree() + scale_color_viridis(discrete = TRUE)
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom")
p4 = facet_plot(p3, panel = "Plastid Targeting", data = gene_data, geom=geom_col, aes(x=Plastid_Targeting), orientation = 'y', fill="chartreuse4") + theme(legend.position = "bottom")
p4
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + hexpand(3)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + hexpand(1.5)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + hexpand(0.5)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + hexpand(0.2)
ggplot(tree_rooted) + geom_tree() + geom_tiplab() + theme_tree() + hexpand(0.25)
p1 = ggplot(tree_rooted, aes(x,y)) + geom_tree() + geom_tiplab(size=2.5) + hexpand(1.5) + theme_tree()
p2 = facet_plot(p1, panel = "Domains", data = gene_data, geom = geom_segment, mapping = aes(x=0, xend=Seq_Length, y=y, yend=y), size=0.5, color='black')
p3 = facet_plot(p2, panel = "Domains", data = gene_data, geom=geom_segment, aes(x=Domain_Start, xend=Domain_End, y=y, yend=y, col=Domain_Name), size=3) + theme(legend.position = "bottom") + scale_color_viridis(discrete = TRUE)
p4 = facet_plot(p3, panel = "Plastid Targeting", data = gene_data, geom=geom_col, aes(x=Plastid_Targeting), orientation = 'y', fill="chartreuse4") + theme(legend.position = "bottom")
p4
ggplot(tree_rooted) + geom_tree() + geom_tiplab(size=3) + theme_tree() + hexpand(0.25) +
geom_hilight(node=36, fill="chartreuse4", alpha=.3, type = "gradient", to.bottom=TRUE, extend=1) +
geom_hilight(node=44, fill="chartreuse4", alpha=.3, type = "gradient", to.bottom=TRUE, extend=1) +
geom_cladelab(node=36, label = "MutS2a", angle=270, hjust = "center", offset=1, offset.text=0.1) +
geom_cladelab(node=44, label = "MutS2b", angle=270, hjust = "center", offset=1, offset.text=0.1)
